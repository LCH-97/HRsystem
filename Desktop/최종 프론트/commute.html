<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commute</title>
    <style>
        /* 코드 1의 스타일 */
        button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 12px; /* 글꼴 크기를 작게 조정합니다. */
            background-color: #f5bf2c; /* 연한 주황색 */
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 187px;
            height: 35px;
        }

        button:hover {
            background-color: #f7a129; /* 마우스를 올렸을 때의 배경색 (보다 진한 주황색) */
        }

        button:active {
            background-color: #FF8C00; /* 클릭했을 때의 배경색 (가장 진한 주황색) */
        }

        #commute-info {
            margin-top: 50px; /* 프로필 사진과 버튼을 내려서 배치합니다. */
            font-size: 12px; /* 글꼴 크기를 조정합니다. */
            text-align: center; /* 텍스트 가운데 정렬합니다. */
            border: 2px solid #f0f0f0; /* 테두리를 추가하고 배경색을 조절합니다. */
            padding: 10px; /* 내부 간격을 조정합니다. */
            max-width: 220px; /* 최대 너비를 설정합니다. */
            margin: auto; /* 가운데 정렬합니다. */
            border-radius: 10px; /* 테두리 모서리를 둥글게 만듭니다. */
            background-color: #f9f9f9; /* 연한 회색 배경색을 설정합니다. */
            position: relative; /* 테두리 위치를 설정합니다. */
        }

        .time {
            margin: 14px 0; /* 근무 시작 위에 좀 더 간격을 주고 텍스트 간격을 조정합니다. */
            font-size: 10px; /* 근무 시작, 퇴근 시간, 총 업무 시간 글씨 크기를 작게 조정합니다. */
            margin-left: -15px;
            margin-top: 36px;
        }

        /* 프로필 사진 스타일 */
        .profile-pic {
            width: 100px; /* 프로필 사진 너비를 조정합니다. */
            height: 100px; /* 프로필 사진 높이를 조정합니다. */
            border-radius: 50%; /* 원형 모양으로 설정합니다. */
            border: 2px solid #FFF; /* 테두리 설정합니다. */
            position: absolute; /* 프로필 사진 위치 설정합니다. */
            top: 75px; /* 위로 올려 프로필 사진을 표시합니다. */
            left: 50%; /* 가운데 정렬합니다. */
            transform: translateX(-50%); /* 수평 가운데 정렬합니다. */
        }

        /* 수정된 스타일 */
        .button-container {
            position: relative; /* 버튼 컨테이너 위치 설정 */
            margin-top: 150px; /* 버튼과 프로필 사진 사이의 간격을 조정합니다. */
        }

        #sumTime {
            margin-top: 15px; /* 총 업무 시간의 위치를 조정합니다. */
            margin-left: 18px;
            margin-top: 2px;
            position: fixed;
            color: gray;
            
        }
    </style>
</head>
<body>

    <div id="commute-info">
        <!-- 프로필 사진 -->
        <img class="profile-pic" src="https://png.pngtree.com/png-clipart/20191121/original/pngtree-user-vector-icon-png-image_5152508.jpg" alt="Profile Picture">
        <!-- "안녕하세요, 이주양님!" 텍스트 -->
        <h2>안녕하세요, 이주양님!</h2>
        <!-- 출퇴근 버튼 -->
        <div class="button-container">
            <button id="commuteButton" onclick="toggleCommute()">출근</button>
        </div>
        <!-- 근무 시작, 근무 종료, 총 업무 시간 -->
        <h1 id="sumTime" class="time">총 업무시간  </h1>
        <h1 id="startTime" class="time">근무 시작  </h1>
        <h1 id="endTime" class="time">근무 종료 </h1>
        
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        let commuteId = null;

        async function startCommute() {
            try {
                const response = await axios.post('http://localhost:8080/employee/commute');
                const startTime = new Date(response.data.startTime).toLocaleString();
                console.log('근무 시작 :', startTime);
                console.log('ID:', response.data.id);
                commuteId = response.data.id;

                // 출근 시간 표시
                document.getElementById('startTime').innerHTML = `근무 시작 ${startTime}`;
            } catch (error) {
                console.error('Failed to start commute:', error);
            }
        }

        async function endCommute() {
            if (!commuteId) {
                console.error('출근을 먼저 해야합니다.');
                return;
            }
            try {
                const response = await axios.patch(`http://localhost:8080/employee/leave/${commuteId}`);
                const endTime = new Date(response.data.endTime).toLocaleString();
                const sumTime = response.data.sumTime;
                console.log('근무 종료:', endTime);
                console.log('총 업무시간:', sumTime);
                commuteId = null;

                // 퇴근 시간 및 총 업무시간 표시
                document.getElementById('endTime').innerHTML = `근무 종료 ${endTime}`;
                document.getElementById('sumTime').innerHTML = `총 업무시간 ${sumTime}`;

            } catch (error) {
                console.error('Failed to end commute:', error);
            }
        }

        function toggleCommute() {
            const commuteButton = document.getElementById('commuteButton');
            if (commuteButton.innerText === '출근') {
                startCommute();
                commuteButton.innerText = '퇴근';
                commuteButton.setAttribute('onclick', 'endCommute()');
            } else {
                endCommute();
                commuteButton.innerText = '출근';
                commuteButton.setAttribute('onclick', 'startCommute()');
            }
        }
    </script>
    
</body>
</html>
